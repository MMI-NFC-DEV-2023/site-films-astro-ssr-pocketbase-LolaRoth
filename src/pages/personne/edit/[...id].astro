---
import { pb } from "../../../backend";
import Layout from "../../../layouts/Layout.astro";
import { PersonneProfessionOptions } from "../../../pocketbase-typegen";
export const prerender = false;

if (Astro.request.method === "POST") {
  const data = await Astro.request.formData();
  const personne = await pb.collection("personne").create(data)
  return Astro.redirect(`/personne/${personne.id}-${personne.nom}`);
}
---

<Layout pageTitle="Edit">
  <h1>Edit personne</h1>
  <form method="post" class="*:contents grid grid-cols-2 ">
    <label
      >nationalite
      <select name="nationalite">
        <option>US</option>
        <option>FR</option>
        <option>UK</option>
      </select>
    </label>
    <label
      >Date Naissance
      <input type="date" name="DateNaissance" />
    </label>
    <label
      >Date Décès
      <input type="date" name="DateDeces" />
    </label>
    <label
      >Lieu Naissance
      <input type="text" name="lieuNaissance" />
    </label>
    <label
      >Nom
      <input type="text" name="nom" />
    </label>
    <label>
        Profession
        <select name="profession" multiple>
            {Object.entries(PersonneProfessionOptions).map(([key, value]) => (
                <option value={key}>{value}</option>
            ))}
        </select>
    </label>
    <button>Envoyer</button>
  </form>
</Layout>
